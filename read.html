<!DOCTYPE html>
<html lang="en">
<head>

  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
    <script>
    // Initialize Firebase with your project's config
    
    firebase.initializeApp(firebaseConfig);

    // Function to check if a user is logged in or not
    function checkAuthState() {
      firebase.auth().onAuthStateChanged(function(user) {
        if (!user) {
          // User is not signed in, redirect to the login page
          window.location.href = "login.html";
        }
      });
    }
    
  </script>

  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Society Poems</title>
  <link rel="stylesheet" href="styles.css"/>
</head>



<body data-theme="night">
  <header>
    <div class="header-content">
      <h1>ðŸ“– Read Submissions</h1>
      <button id="toggleTheme" aria-label="Toggle Theme">ðŸŽ¨ Theme</button>
    </div>
  </header>

  <main id="entriesContainer">
    <p>Loading submissions...</p>
  </main>

  <footer>
    <p>&copy; 2025 Society Poems</p>
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

    const firebaseConfig = {
    apiKey: "AIzaSyBDbJeNC663MJR1td2xcpfSLoAgj8eijZE",
    authDomain: "society-poems.firebaseapp.com",
    projectId: "society-poems",
    storageBucket: "society-poems.firebasestorage.app",
    messagingSenderId: "774942255629",
    appId: "1:774942255629:web:387605f02620c80ec10344"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const entriesRef = ref(db, 'uploads');
    const container = document.getElementById('entriesContainer');

    onValue(entriesRef, (snapshot) => {
      container.innerHTML = '';
      const data = snapshot.val();
      if (!data) {
        container.innerHTML = '<p>No entries yet. Be the first to upload!</p>';
        return;
      }

      const entries = Object.values(data).reverse();
      entries.forEach(entry => {
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `
          <p>${entry.content.replace(/\\n/g, '<br/>')}</p>
          <div class="entry-meta">â€” <strong>${entry.name}</strong>, <em>${entry.timestamp}</em></div>
        `;
        container.appendChild(div);
      });
    });
  </script>

  <script src="theme-toggle.js"></script>
</body>
</html>
